(()=>{var e={n:o=>{var t=o&&o.__esModule?()=>o.default:()=>o;return e.d(t,{a:t}),t},d:(o,t)=>{for(var n in t)e.o(t,n)&&!e.o(o,n)&&Object.defineProperty(o,n,{enumerable:!0,get:t[n]})},o:(e,o)=>Object.prototype.hasOwnProperty.call(e,o)};(()=>{"use strict";const o=flarum.core.compat["forum/app"];var t=e.n(o);const n=flarum.core.compat["common/extend"],r=flarum.core.compat["forum/states/DiscussionListState"];var a=e.n(r);const c=flarum.core.compat["forum/components/DiscussionListItem"];var s=e.n(c);const i=flarum.core.compat["forum/components/DiscussionPage"];var l=e.n(i);const u=flarum.core.compat["common/components/TextEditor"];var f=e.n(u);const d=flarum.core.compat["common/components/TextEditorButton"];var p=e.n(d);const b=flarum.core.compat["common/components/Button"];var v=e.n(b);const h=flarum.core.compat["common/utils/abbreviateNumber"];var g=e.n(h);const k=flarum.core.compat["common/helpers/icon"];var y=e.n(k);const x=flarum.core.compat["common/utils/classList"];var z=e.n(x);const I=flarum.core.compat["common/utils/styleSelectedText"];var L=e.n(I),S="zhihe.postFontSize",q="normal";function w(e){document.body.classList.remove("zhihe-font-large","zhihe-font-larger"),"large"===e?document.body.classList.add("zhihe-font-large"):"larger"===e&&document.body.classList.add("zhihe-font-larger"),localStorage.setItem(S,e),q=e}t().initializers.add("zhihe-ui",function(){var e=t().session&&t().session.user;w(e&&e.preferences()&&e.preferences()[S]||localStorage.getItem(S)||"normal"),(0,n.extend)(s().prototype,"infoItems",function(e){var o=this.attrs.discussion,t=o.replyCount(),n=o.isUnread();e.add("mobile-reply-count",m("span",{className:z()("item-mobile-reply-count",{unread:n}),onclick:n?this.markAsRead.bind(this):void 0},[y()(n?"fas fa-comment":"far fa-comment")," ",g()(t)]),10)});var o={normal:"A",large:"A+",larger:"A++"},r={normal:"large",large:"larger",larger:"normal"};(0,n.extend)(l().prototype,"sidebarItems",function(e){e.add("fontSizeToggle",v().component({className:"Button Button--block",icon:"fas fa-font",onclick:function(){var e,o=r[q];w(o),t().session&&t().session.user&&t().session.user.savePreferences(((e={})[S]=o,e)),m.redraw()}},"字体 "+o[q]),4)}),(0,n.extend)(f().prototype,"toolbarItems",function(e){var o=this,t=function(){return o.attrs.composer.editor},n=function(e,o){return function(){return L()(t().el,{prefix:e,suffix:o,trimFirst:!0})}};e.add("bb-bold",p().component({title:"粗体 [b]",icon:"fas fa-bold",onclick:n("[b]","[/b]")}),900),e.add("bb-italic",p().component({title:"斜体 [i]",icon:"fas fa-italic",onclick:n("[i]","[/i]")}),800),e.add("bb-underline",p().component({title:"下划线 [u]",icon:"fas fa-underline",onclick:n("[u]","[/u]")}),700),e.add("bb-strikethrough",p().component({title:"删除线 [s]",icon:"fas fa-strikethrough",onclick:n("[s]","[/s]")}),600),e.add("bb-quote",p().component({title:"引用 [quote]",icon:"fas fa-quote-left",onclick:n("[quote]","[/quote]")}),500),e.add("bb-link",p().component({title:"链接 [url]",icon:"fas fa-link",onclick:function(){return L()(t().el,{prefix:"[url=https://]",suffix:"[/url]",trimFirst:!0})}}),400),e.add("bb-size",p().component({title:"字号 [size]",icon:"fas fa-text-height",onclick:n("[size=18]","[/size]")}),300)}),(0,n.override)(a().prototype,"sortMap",function(e){var o=e(),t={};for(var n in"relevance"in o&&(t.relevance=o.relevance),"latest"in o&&(t.latest=o.latest),"newest"in o&&(t.newest=o.newest),o)n in t||(t[n]=o[n]);return t})})})(),module.exports={}})();
//# sourceMappingURL=forum.js.map